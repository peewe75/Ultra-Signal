rules_version='2'

service cloud.firestore {
  match /databases/{database}/documents {
      // Only allow users to read/write their own user document
      match /users/{userId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;

        // Allow users to read their own licenses, but writes should ideally be done by Admin SDK
        match /licenses/{licenseId} {
          allow read: if request.auth != null && request.auth.uid == userId;
          allow write: if request.auth != null && request.auth.uid == userId; // Keeping write open for test mocks for now
        }
      }
  }
}
